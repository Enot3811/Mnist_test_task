Честно говоря, лишь в самом-самом конце увидел указание "делайте решение максимально компактным". Надеюсь, оно не покажется вам слишком монструозным.

В целом, mnist довольно простая задача. Я за несколько часов собрал маленькую сетку и обучил в google colab (блокнот тоже приложил). И там как раз всё весьма компактно.
Большую же часть времени переделывал всё под требования.

Мне показалось не очень удобным читать путь для каждой картинки из csv, учитывая то, что набор данных уже идеально подходит под встроенную считывалку ImageFolder из torch, но так или иначе сделал как сказали. Написал маленькую дополнительную функцию как раз для создания csv для картинок (ничего особенного, но тоже приложил).

В скрипт всё упаковывать тоже было немного непривычно. Обычно делал всё интерактивно в блокноте, а здесь надо было всё в кучу собрать, но вроде бы всё работает. Причём как на локальной машине (проверял на windows), так и в colab на linux (в приложенном блокноте последние 3 ячейки).


Сейчас в csv пути расчитаны на то, что папка с картинками лежит рядом со скриптами. Это можно исправить, но решил с путями уже не дёргаться сильно, так что при запуске положите всё в одну директорию.


В общем, буду ждать вашего отзыва.